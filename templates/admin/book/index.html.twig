{% extends 'base.html.twig' %}

{% block body %}
    <a href="{{ path('admin_book_new') }}" class="btn btn-block btn-success my-3">
        Create book
    </a>

    {% if books %}
        <table class="table align-middle">
            <thead>
            <tr>
                <th scope="col">Title</th>
                <th scope="col">Year</th>
                <th scope="col">ISBN</th>
                <th scope="col">Authors</th>
                <th scope="col">Cover</th>
                <th scope="col">Actions</th>
            </tr>
            </thead>

            <tbody>
            {% for book in books %}
                <tr>
                    <td>{{ book.title }}</td>
                    <td>{{ book.year }}</td>
                    <td>{{ book.isbn }}</td>
                    <td>{{ book.authors.count > 0 ? book.authors|join('; ') : '-' }}</td>
                    <td>
                        <img src="/{{ book_covers_directory ~ '/' ~ book.coverFilename }}" alt="book cover"
                             style="max-height: 100px">
                    </td>
                    <td>
                        <div class="d-flex">
                            <a href="{{ path('admin_book_edit', {id: book.id}) }}" class="btn btn-sm btn-primary">
                                Edit
                            </a>

                            <form action="{{ url('admin_book_delete', {id: book.id}) }}" method="POST" class="ms-2">
                                <input type="hidden" name="token" value="{{ csrf_token('delete') }}"/>
                                <button type="submit" class="btn btn-sm btn-danger">Delete</button>
                            </form>
                        </div>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    {% else %}
        <h1>No books yet</h1>
    {% endif %}
{% endblock %}
